<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.itec.mapper.BillDetlMapper">
  <resultMap id="BaseResultMap" type="com.itec.pojo.BillDetl">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jan 03 13:11:56 HKT 2025.
    -->
    <id column="BILLDETL_ID" jdbcType="BIGINT" property="billdetlId" />
    <id column="BILLDETL_NO" jdbcType="VARCHAR" property="billdetlNo" />
    <result column="BILLDETL_ENGINEER_NM" jdbcType="VARCHAR" property="billdetlEngineerNm" />
    <result column="BILLDETL_PRICE_PER" jdbcType="INTEGER" property="billdetlPricePer" />
    <result column="BILLDETL_AMOUNT" jdbcType="INTEGER" property="billdetlAmount" />
    <result column="BILLDETL_DEDU_TIME" jdbcType="INTEGER" property="billdetlDeduTime" />
    <result column="BILLDETL_EXCESS_TIME" jdbcType="INTEGER" property="billdetlExcessTime" />
    <result column="BILLDETL_DEDU_UNITPRICE" jdbcType="INTEGER" property="billdetlDeduUnitprice" />
    <result column="BILLDETL_EXCESS_UNITPRICE" jdbcType="INTEGER" property="billdetlExcessUnitprice" />
    <result column="BILLDETL_PRETAXAMO" jdbcType="INTEGER" property="billdetlPretaxamo" />
    <result column="BILLDETL_TRANS_EXPENSES" jdbcType="INTEGER" property="billdetlTransExpenses" />
    <result column="BILLDETL_TOTALAMO" jdbcType="INTEGER" property="billdetlTotalamo" />
    <result column="BILLDETL_RMK" jdbcType="VARCHAR" property="billdetlRmk" />
    <result column="BILLDETL_CRD_USR" jdbcType="VARCHAR" property="billdetlCrdUsr" />
    <result column="BILLDETL_CRD_DT" jdbcType="TIMESTAMP" property="billdetlCrdDt" />
    <result column="BILLDETL_UPD_USR" jdbcType="VARCHAR" property="billdetlUpdUsr" />
    <result column="BILLDETL_UPD_DT" jdbcType="TIMESTAMP" property="billdetlUpdDt" />
  </resultMap>
  <sql id="Base_Column_List">
    <!--
      WARNING - @mbg.generated
      This element is automatically generated by MyBatis Generator, do not modify.
      This element was generated on Fri Jan 03 13:11:56 HKT 2025.
    -->
    BILLDETL_ID, BILLDETL_NO, BILLDETL_ENGINEER_NM, BILLDETL_PRICE_PER, BILLDETL_AMOUNT, 
    BILLDETL_DEDU_TIME, BILLDETL_EXCESS_TIME, BILLDETL_DEDU_UNITPRICE, BILLDETL_EXCESS_UNITPRICE, 
    BILLDETL_PRETAXAMO, BILLDETL_TRANS_EXPENSES, BILLDETL_TOTALAMO, BILLDETL_RMK, BILLDETL_CRD_USR, 
    BILLDETL_CRD_DT, BILLDETL_UPD_USR, BILLDETL_UPD_DT
  </sql>
  
  <!--单独新增-->
  <insert id="insertBillDetl" parameterType="com.itec.pojo.BillDetl">
    insert into BILLDETL_TBL (BILLDETL_ID, BILLDETL_NO, BILLDETL_ENGINEER_NM, 
      BILLDETL_PRICE_PER, BILLDETL_AMOUNT, BILLDETL_DEDU_TIME, 
      BILLDETL_EXCESS_TIME, BILLDETL_DEDU_UNITPRICE, 
      BILLDETL_EXCESS_UNITPRICE, BILLDETL_PRETAXAMO, 
      BILLDETL_TRANS_EXPENSES, BILLDETL_TOTALAMO, 
      BILLDETL_RMK, BILLDETL_CRD_USR, BILLDETL_CRD_DT, 
      BILLDETL_UPD_USR, BILLDETL_UPD_DT)
      <foreach collection="list" item="item" separator=",">
    (#{billdetlId,jdbcType=BIGINT}, #{billdetlNo,jdbcType=VARCHAR}, #{billdetlEngineerNm,jdbcType=VARCHAR}, 
      #{billdetlPricePer,jdbcType=INTEGER}, #{billdetlAmount,jdbcType=VARCHAR}, #{billdetlDeduTime,jdbcType=VARCHAR}, 
      #{billdetlExcessTime,jdbcType=VARCHAR}, #{billdetlDeduUnitprice,jdbcType=INTEGER}, 
      #{billdetlExcessUnitprice,jdbcType=INTEGER}, #{billdetlPretaxamo,jdbcType=INTEGER}, 
      #{billdetlTransExpenses,jdbcType=INTEGER}, #{billdetlTotalamo,jdbcType=VARCHAR}, 
      #{billdetlRmk,jdbcType=VARCHAR}, #{billdetlCrdUsr,jdbcType=VARCHAR}, #{billdetlCrdDt,jdbcType=TIMESTAMP}, 
      #{billdetlUpdUsr,jdbcType=VARCHAR}, #{billdetlUpdDt,jdbcType=TIMESTAMP})
       </foreach>
  </insert>
  
  <!--批量更新 如果ID匹配，则更新字段；如果不匹配，则保持原值不变-->
  <update id="updateBillDetlByBillDetlNo" parameterType="java.util.List">
    UPDATE BILLDETL_TBL
    SET
        BILLDETL_ENGINEER_NM = CASE
            <foreach collection="list" item="item" separator=" ">
                WHEN BILLDETL_ID = #{item.billdetlId, jdbcType=BIGINT} THEN #{item.billdetlEngineerNm, jdbcType=VARCHAR}
            </foreach>
            ELSE BILLDETL_ENGINEER_NM
        END,
        BILLDETL_PRICE_PER = CASE
            <foreach collection="list" item="item" separator=" ">
                WHEN BILLDETL_ID = #{item.billdetlId, jdbcType=BIGINT} THEN #{item.billdetlPricePer, jdbcType=INTEGER}
            </foreach>
            ELSE BILLDETL_PRICE_PER
        END,
        BILLDETL_AMOUNT = CASE
            <foreach collection="list" item="item" separator=" ">
                WHEN BILLDETL_ID = #{item.billdetlId, jdbcType=BIGINT} THEN #{item.billdetlAmount, jdbcType=VARCHAR}
            </foreach>
            ELSE BILLDETL_AMOUNT
        END,
        BILLDETL_DEDU_TIME = CASE
            <foreach collection="list" item="item" separator=" ">
                WHEN BILLDETL_ID = #{item.billdetlId, jdbcType=BIGINT} THEN #{item.billdetlDeduTime, jdbcType=VARCHAR}
            </foreach>
            ELSE BILLDETL_DEDU_TIME
        END,
        BILLDETL_EXCESS_TIME = CASE
            <foreach collection="list" item="item" separator=" ">
                WHEN BILLDETL_ID = #{item.billdetlId, jdbcType=BIGINT} THEN #{item.billdetlExcessTime, jdbcType=VARCHAR}
            </foreach>
            ELSE BILLDETL_EXCESS_TIME
        END,
        BILLDETL_DEDU_UNITPRICE = CASE
            <foreach collection="list" item="item" separator=" ">
                WHEN BILLDETL_ID = #{item.billdetlId, jdbcType=BIGINT} THEN #{item.billdetlDeduUnitprice, jdbcType=INTEGER}
            </foreach>
            ELSE BILLDETL_DEDU_UNITPRICE
        END,
        BILLDETL_EXCESS_UNITPRICE = CASE
            <foreach collection="list" item="item" separator=" ">
                WHEN BILLDETL_ID = #{item.billdetlId, jdbcType=BIGINT} THEN #{item.billdetlExcessUnitprice, jdbcType=INTEGER}
            </foreach>
            ELSE BILLDETL_EXCESS_UNITPRICE
        END,
        BILLDETL_PRETAXAMO = CASE
            <foreach collection="list" item="item" separator=" ">
                WHEN BILLDETL_ID = #{item.billdetlId, jdbcType=BIGINT} THEN #{item.billdetlPretaxamo, jdbcType=INTEGER}
            </foreach>
            ELSE BILLDETL_PRETAXAMO
        END,
        BILLDETL_TRANS_EXPENSES = CASE
            <foreach collection="list" item="item" separator=" ">
                WHEN BILLDETL_ID = #{item.billdetlId, jdbcType=BIGINT} THEN #{item.billdetlTransExpenses, jdbcType=INTEGER}
            </foreach>
            ELSE BILLDETL_TRANS_EXPENSES
        END,
        BILLDETL_TOTALAMO = CASE
            <foreach collection="list" item="item" separator=" ">
                WHEN BILLDETL_ID = #{item.billdetlId, jdbcType=BIGINT} THEN #{item.billdetlTotalamo, jdbcType=VARCHAR}
            </foreach>
            ELSE BILLDETL_TOTALAMO
        END,
        BILLDETL_RMK = CASE
            <foreach collection="list" item="item" separator=" ">
                WHEN BILLDETL_ID = #{item.billdetlId, jdbcType=BIGINT} THEN #{item.billdetlRmk, jdbcType=VARCHAR}
            </foreach>
            ELSE BILLDETL_RMK
        END,
        BILLDETL_CRD_USR = CASE
            <foreach collection="list" item="item" separator=" ">
                WHEN BILLDETL_ID = #{item.billdetlId, jdbcType=BIGINT} THEN #{item.billdetlCrdUsr, jdbcType=VARCHAR}
            </foreach>
            ELSE BILLDETL_CRD_USR
        END,
        BILLDETL_CRD_DT = CASE
            <foreach collection="list" item="item" separator=" ">
                WHEN BILLDETL_ID = #{item.billdetlId, jdbcType=BIGINT} THEN #{item.billdetlCrdDt, jdbcType=TIMESTAMP}
            </foreach>
            ELSE BILLDETL_CRD_DT
        END,
        BILLDETL_UPD_USR = CASE
            <foreach collection="list" item="item" separator=" ">
                WHEN BILLDETL_ID = #{item.billdetlId, jdbcType=BIGINT} THEN #{item.billdetlUpdUsr, jdbcType=VARCHAR}
            </foreach>
            ELSE BILLDETL_UPD_USR
        END,
        BILLDETL_UPD_DT = CASE
            <foreach collection="list" item="item" separator=" ">
                WHEN BILLDETL_ID = #{item.billdetlId, jdbcType=BIGINT} THEN #{item.billdetlUpdDt, jdbcType=TIMESTAMP}
            </foreach>
            ELSE BILLDETL_UPD_DT
        END
    WHERE BILLDETL_NO = #{list[0].billdetlNo, jdbcType=VARCHAR}
</update>
</mapper>